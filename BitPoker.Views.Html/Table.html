<!DOCTYPE html>
<html>
<head>
    <title>BitPoker.io</title>
	<meta charset="utf-8" />
    <script src="https://code.jquery.com/jquery-3.1.1.min.js" integrity="sha256-hVVnYaiADRTO2PzUGmuLJr8BLUSjGIZsDYGmIJLv2b8=" crossorigin="anonymous"></script>
</head>
<body>
    <h1 id="table">Table </h1>
	<p id="tabledetails"></p>

    <h2>Last Actions</h2>
    <table id="actions"></table>
	<button type="button" onclick="refresh()">Refresh</button>

    <h2>Previous Hands</h2>

    <table id="history"></table>

    <p>Join</p>
    <button type="button" onclick="join()">Join Table</button>

    <p>Buy in transaction</p>
    <input name="buyInTx" />
    <button type="button" onclick="buyIn()">Buy In</button>

    <h2>Build a tx</h2>

    <p id="key"></p>

    <button type="button" onclick="join()">Random</button>

    
    <script>	
        $(document).ready(function () {
			var tablesUri = 'http://localhost:5000/api/tables/bf368921-346a-42d8-9cb8-621f9cad5e16';
			var handsUri = 'http://localhost:5000/api/hands/bf368921-346a-42d8-9cb8-621f9cad5e16';
			var logsUri = 'http://localhost:5000/api/logs';

			refresh();
			
         	$.getJSON(tablesUri)
	         	.done(function (response) {
                  	$('#table').append(response.Id);
					$('#tabledetables').append(response.SmallBlind + ' ' + response.BigBlind);
          	});

	         $.getJSON(handsUri)
	         	.done(function (response) {
	              	$.each(response, function (key, item) {
	                  	$('#history').append('<tr><td>' + item.Index + '</td><td>' + item.TimeStamp + '</td><td>' + item.Id + '</tr>');
	              });
          	});

			function refresh(){
		         $.getJSON(logsUri)
		         	.done(function (response) {
		              	$.each(response, function (key, item) {
		                  	$('#history').append('<tr><td>' + item.Index + '</td><td>' + item.TimeStamp + '</td><td>' + item.Id + '</tr>');
		              });
					setTimeout(refresh,5000);
		      	});
			}
        });

        function join() {

            var request = {
                Seat: 1
            };

            $.post("http://localhost:5000/api/tables/join", request)
              .done(function (data) {
                  alert("Data Loaded: " + data);
              });
        }

        function buyIn() {

        }
			
    </script>
</body>
</html>
